[gd_scene load_steps=36 format=3 uid="uid://6o4kyp2gho2g"]

[ext_resource type="Script" uid="uid://dvb7wboys0hqx" path="res://scenes/game/scripts/train.gd" id="1_o8b33"]
[ext_resource type="PackedScene" uid="uid://c7la581tjpoe2" path="res://scenes/world/env.tscn" id="3_3p7xb"]
[ext_resource type="Material" uid="uid://cr6c0y0fooqqb" path="res://assets/mats/mat_dark_blue.tres" id="3_etkum"]
[ext_resource type="PackedScene" uid="uid://cpfggxvqf6g2b" path="res://scenes/player/player.tscn" id="3_l6sq7"]
[ext_resource type="Resource" uid="uid://dv1j63w4b0wqk" path="res://dialogue/train_dialogue_01.dialogue" id="3_qwiof"]
[ext_resource type="Script" uid="uid://7bul5v4kxvtb" path="res://scenes/ui/interact_label.gd" id="3_secdc"]
[ext_resource type="Script" uid="uid://c7ta7ok1g6l83" path="res://scenes/world/scripts/flicker_component.gd" id="5_gkh44"]
[ext_resource type="Script" uid="uid://cuiiftb0iqpm5" path="res://scenes/interactables/world_light.gd" id="7_t1try"]
[ext_resource type="Resource" uid="uid://b16n357oao8a4" path="res://dialogue/intro_sign_dialogue.dialogue" id="8_j8erv"]
[ext_resource type="Script" uid="uid://bb2wkvxlsjtw0" path="res://scenes/interactables/invisible_area.gd" id="9_secdc"]
[ext_resource type="Script" uid="uid://bejw17crfjdit" path="res://scripts/components/interactable_component.gd" id="9_t1try"]
[ext_resource type="Script" uid="uid://b2ho48wskc5no" path="res://scenes/interactables/invisible_sign.gd" id="11_t1try"]

[sub_resource type="BoxShape3D" id="BoxShape3D_gkh44"]
size = Vector3(4, 5, 5)

[sub_resource type="BoxMesh" id="BoxMesh_dg8lw"]
size = Vector3(24, 1, 18)

[sub_resource type="ConcavePolygonShape3D" id="ConcavePolygonShape3D_d3hrk"]
data = PackedVector3Array(-12, 0.5, 9, 12, 0.5, 9, -12, -0.5, 9, 12, 0.5, 9, 12, -0.5, 9, -12, -0.5, 9, 12, 0.5, -9, -12, 0.5, -9, 12, -0.5, -9, -12, 0.5, -9, -12, -0.5, -9, 12, -0.5, -9, 12, 0.5, 9, 12, 0.5, -9, 12, -0.5, 9, 12, 0.5, -9, 12, -0.5, -9, 12, -0.5, 9, -12, 0.5, -9, -12, 0.5, 9, -12, -0.5, -9, -12, 0.5, 9, -12, -0.5, 9, -12, -0.5, -9, 12, 0.5, 9, -12, 0.5, 9, 12, 0.5, -9, -12, 0.5, 9, -12, 0.5, -9, 12, 0.5, -9, -12, -0.5, 9, 12, -0.5, 9, -12, -0.5, -9, 12, -0.5, 9, 12, -0.5, -9, -12, -0.5, -9)

[sub_resource type="ConcavePolygonShape3D" id="ConcavePolygonShape3D_j8erv"]
data = PackedVector3Array(-12, 0.5, 9, 12, 0.5, 9, -12, -0.5, 9, 12, 0.5, 9, 12, -0.5, 9, -12, -0.5, 9, 12, 0.5, -9, -12, 0.5, -9, 12, -0.5, -9, -12, 0.5, -9, -12, -0.5, -9, 12, -0.5, -9, 12, 0.5, 9, 12, 0.5, -9, 12, -0.5, 9, 12, 0.5, -9, 12, -0.5, -9, 12, -0.5, 9, -12, 0.5, -9, -12, 0.5, 9, -12, -0.5, -9, -12, 0.5, 9, -12, -0.5, 9, -12, -0.5, -9, 12, 0.5, 9, -12, 0.5, 9, 12, 0.5, -9, -12, 0.5, 9, -12, 0.5, -9, 12, 0.5, -9, -12, -0.5, 9, 12, -0.5, 9, -12, -0.5, -9, 12, -0.5, 9, 12, -0.5, -9, -12, -0.5, -9)

[sub_resource type="BoxMesh" id="BoxMesh_q3b41"]
size = Vector3(24, 4, 6)

[sub_resource type="ConcavePolygonShape3D" id="ConcavePolygonShape3D_q3b41"]
data = PackedVector3Array(-12, 2, 3, 12, 2, 3, -12, -2, 3, 12, 2, 3, 12, -2, 3, -12, -2, 3, 12, 2, -3, -12, 2, -3, 12, -2, -3, -12, 2, -3, -12, -2, -3, 12, -2, -3, 12, 2, 3, 12, 2, -3, 12, -2, 3, 12, 2, -3, 12, -2, -3, 12, -2, 3, -12, 2, -3, -12, 2, 3, -12, -2, -3, -12, 2, 3, -12, -2, 3, -12, -2, -3, 12, 2, 3, -12, 2, 3, 12, 2, -3, -12, 2, 3, -12, 2, -3, 12, 2, -3, -12, -2, 3, 12, -2, 3, -12, -2, -3, 12, -2, 3, 12, -2, -3, -12, -2, -3)

[sub_resource type="PrismMesh" id="PrismMesh_q3b41"]
left_to_right = 0.0
size = Vector3(18, 4, 3)

[sub_resource type="ConcavePolygonShape3D" id="ConcavePolygonShape3D_3p7xb"]
data = PackedVector3Array(-9, 2, 1.5, 9, -2, 1.5, -9, -2, 1.5, -9, 2, -1.5, -9, -2, -1.5, 9, -2, -1.5, -9, 2, 1.5, -9, 2, -1.5, 9, -2, 1.5, -9, 2, -1.5, 9, -2, -1.5, 9, -2, 1.5, -9, 2, -1.5, -9, 2, 1.5, -9, -2, -1.5, -9, 2, 1.5, -9, -2, 1.5, -9, -2, -1.5, -9, -2, 1.5, 9, -2, 1.5, -9, -2, -1.5, 9, -2, 1.5, 9, -2, -1.5, -9, -2, -1.5)

[sub_resource type="BoxMesh" id="BoxMesh_qqcam"]
size = Vector3(4, 4, 3)

[sub_resource type="ConcavePolygonShape3D" id="ConcavePolygonShape3D_ecthn"]
data = PackedVector3Array(-2, 2, 1.5, 2, 2, 1.5, -2, -2, 1.5, 2, 2, 1.5, 2, -2, 1.5, -2, -2, 1.5, 2, 2, -1.5, -2, 2, -1.5, 2, -2, -1.5, -2, 2, -1.5, -2, -2, -1.5, 2, -2, -1.5, 2, 2, 1.5, 2, 2, -1.5, 2, -2, 1.5, 2, 2, -1.5, 2, -2, -1.5, 2, -2, 1.5, -2, 2, -1.5, -2, 2, 1.5, -2, -2, -1.5, -2, 2, 1.5, -2, -2, 1.5, -2, -2, -1.5, 2, 2, 1.5, -2, 2, 1.5, 2, 2, -1.5, -2, 2, 1.5, -2, 2, -1.5, 2, 2, -1.5, -2, -2, 1.5, 2, -2, 1.5, -2, -2, -1.5, 2, -2, 1.5, 2, -2, -1.5, -2, -2, -1.5)

[sub_resource type="BoxMesh" id="BoxMesh_ecthn"]
size = Vector3(8, 8, 24)

[sub_resource type="ConcavePolygonShape3D" id="ConcavePolygonShape3D_qqcam"]
data = PackedVector3Array(-4, 4, 12, 4, 4, 12, -4, -4, 12, 4, 4, 12, 4, -4, 12, -4, -4, 12, 4, 4, -12, -4, 4, -12, 4, -4, -12, -4, 4, -12, -4, -4, -12, 4, -4, -12, 4, 4, 12, 4, 4, -12, 4, -4, 12, 4, 4, -12, 4, -4, -12, 4, -4, 12, -4, 4, -12, -4, 4, 12, -4, -4, -12, -4, 4, 12, -4, -4, 12, -4, -4, -12, 4, 4, 12, -4, 4, 12, 4, 4, -12, -4, 4, 12, -4, 4, -12, 4, 4, -12, -4, -4, 12, 4, -4, 12, -4, -4, -12, 4, -4, 12, 4, -4, -12, -4, -4, -12)

[sub_resource type="BoxMesh" id="BoxMesh_3p7xb"]
size = Vector3(60, 2, 8)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_3p7xb"]
albedo_color = Color(0.354652, 0.177811, 7.21961e-07, 1)

[sub_resource type="BoxShape3D" id="BoxShape3D_qqcam"]
size = Vector3(60, 8, 8)

[sub_resource type="BoxShape3D" id="BoxShape3D_secdc"]
size = Vector3(2, 10, 4)

[sub_resource type="BoxShape3D" id="BoxShape3D_j8erv"]

[sub_resource type="BoxMesh" id="BoxMesh_j8erv"]

[sub_resource type="ConcavePolygonShape3D" id="ConcavePolygonShape3D_t1try"]
data = PackedVector3Array(-0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5)

[sub_resource type="BoxShape3D" id="BoxShape3D_t1try"]
size = Vector3(5, 4, 0.1)

[sub_resource type="BoxMesh" id="BoxMesh_ef2u0"]
size = Vector3(5, 4, 0.2)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_nkto6"]
albedo_color = Color(1, 0.29, 0.29, 1)

[sub_resource type="ConcavePolygonShape3D" id="ConcavePolygonShape3D_ycsv1"]
data = PackedVector3Array(-2.5, 2, 0.1, 2.5, 2, 0.1, -2.5, -2, 0.1, 2.5, 2, 0.1, 2.5, -2, 0.1, -2.5, -2, 0.1, 2.5, 2, -0.1, -2.5, 2, -0.1, 2.5, -2, -0.1, -2.5, 2, -0.1, -2.5, -2, -0.1, 2.5, -2, -0.1, 2.5, 2, 0.1, 2.5, 2, -0.1, 2.5, -2, 0.1, 2.5, 2, -0.1, 2.5, -2, -0.1, 2.5, -2, 0.1, -2.5, 2, -0.1, -2.5, 2, 0.1, -2.5, -2, -0.1, -2.5, 2, 0.1, -2.5, -2, 0.1, -2.5, -2, -0.1, 2.5, 2, 0.1, -2.5, 2, 0.1, 2.5, 2, -0.1, -2.5, 2, 0.1, -2.5, 2, -0.1, 2.5, 2, -0.1, -2.5, -2, 0.1, 2.5, -2, 0.1, -2.5, -2, -0.1, 2.5, -2, 0.1, 2.5, -2, -0.1, -2.5, -2, -0.1)

[node name="train" type="Node3D" node_paths=PackedStringArray("exit_area", "spawn_pos_alley")]
script = ExtResource("1_o8b33")
exit_area = NodePath("exit_area")
spawn_pos_alley = NodePath("spawn_pos/spawn_from_alley")
self_dialogue_01 = ExtResource("3_qwiof")

[node name="ui" type="CanvasLayer" parent="."]

[node name="interact_label" type="Label" parent="ui"]
visible = false
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -51.0
offset_top = -105.0
offset_right = 51.0
offset_bottom = -82.0
grow_horizontal = 2
grow_vertical = 2
text = "[f] to interact"
script = ExtResource("3_secdc")

[node name="env" parent="." instance=ExtResource("3_3p7xb")]

[node name="player" parent="." instance=ExtResource("3_l6sq7")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)

[node name="exit_area" type="Area3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -12.2395)
collision_layer = 0

[node name="CollisionShape3D" type="CollisionShape3D" parent="exit_area"]
shape = SubResource("BoxShape3D_gkh44")

[node name="world" type="Node3D" parent="."]

[node name="floor" type="MeshInstance3D" parent="world"]
mesh = SubResource("BoxMesh_dg8lw")
skeleton = NodePath("../..")
surface_material_override/0 = ExtResource("3_etkum")

[node name="StaticBody3D" type="StaticBody3D" parent="world/floor"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="world/floor/StaticBody3D"]
visible = false
shape = SubResource("ConcavePolygonShape3D_d3hrk")

[node name="floor_alley" type="MeshInstance3D" parent="world"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -17)
mesh = SubResource("BoxMesh_dg8lw")
skeleton = NodePath("../..")
surface_material_override/0 = ExtResource("3_etkum")

[node name="StaticBody3D" type="StaticBody3D" parent="world/floor_alley"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="world/floor_alley/StaticBody3D"]
visible = false
shape = SubResource("ConcavePolygonShape3D_j8erv")

[node name="platform" type="MeshInstance3D" parent="world"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 2, 12)
mesh = SubResource("BoxMesh_q3b41")

[node name="StaticBody3D" type="StaticBody3D" parent="world/platform"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="world/platform/StaticBody3D"]
visible = false
shape = SubResource("ConcavePolygonShape3D_q3b41")

[node name="ramp" type="MeshInstance3D" parent="world"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 2, 8)
mesh = SubResource("PrismMesh_q3b41")

[node name="StaticBody3D" type="StaticBody3D" parent="world/ramp"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="world/ramp/StaticBody3D"]
visible = false
shape = SubResource("ConcavePolygonShape3D_3p7xb")

[node name="ramp_box" type="MeshInstance3D" parent="world"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -10, 2, 8)
mesh = SubResource("BoxMesh_qqcam")

[node name="StaticBody3D" type="StaticBody3D" parent="world/ramp_box"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="world/ramp_box/StaticBody3D"]
visible = false
shape = SubResource("ConcavePolygonShape3D_ecthn")

[node name="wall_east" type="MeshInstance3D" parent="world"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 16, 4, 3)
mesh = SubResource("BoxMesh_ecthn")

[node name="StaticBody3D" type="StaticBody3D" parent="world/wall_east"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="world/wall_east/StaticBody3D"]
visible = false
shape = SubResource("ConcavePolygonShape3D_qqcam")

[node name="wall_northeast" type="MeshInstance3D" parent="world"]
transform = Transform3D(-4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, 14, 4, -13)
mesh = SubResource("BoxMesh_ecthn")

[node name="StaticBody3D" type="StaticBody3D" parent="world/wall_northeast"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="world/wall_northeast/StaticBody3D"]
visible = false
shape = SubResource("ConcavePolygonShape3D_qqcam")

[node name="wall_northwest" type="MeshInstance3D" parent="world"]
transform = Transform3D(-4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, -14, 4, -13)
mesh = SubResource("BoxMesh_ecthn")

[node name="StaticBody3D" type="StaticBody3D" parent="world/wall_northwest"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="world/wall_northwest/StaticBody3D"]
visible = false
shape = SubResource("ConcavePolygonShape3D_qqcam")

[node name="wall_west" type="MeshInstance3D" parent="world"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -16, 4, 3)
mesh = SubResource("BoxMesh_ecthn")

[node name="StaticBody3D" type="StaticBody3D" parent="world/wall_west"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="world/wall_west/StaticBody3D"]
visible = false
shape = SubResource("ConcavePolygonShape3D_qqcam")

[node name="tracks" type="MeshInstance3D" parent="world"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 19)
mesh = SubResource("BoxMesh_3p7xb")
surface_material_override/0 = SubResource("StandardMaterial3D_3p7xb")

[node name="StaticBody3D" type="StaticBody3D" parent="world/tracks"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="world/tracks/StaticBody3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 4, 0.299999)
visible = false
shape = SubResource("BoxShape3D_qqcam")

[node name="lights" type="Node" parent="."]

[node name="SpotLight3D" type="SpotLight3D" parent="lights"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 9.90166, 1.57132, 1.0905)
light_energy = 16.0
shadow_enabled = true
spot_range = 20.0
spot_attenuation = 0.1
spot_angle = 20.0
spot_angle_attenuation = 0.1

[node name="world_light_01" type="SpotLight3D" parent="lights" node_paths=PackedStringArray("area_3d")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -8.09834, 1.57132, 1.0905)
light_energy = 16.0
shadow_enabled = true
spot_range = 20.0
spot_attenuation = 0.1
spot_angle = 20.0
spot_angle_attenuation = 0.1
script = ExtResource("7_t1try")
area_3d = NodePath("Area3D")

[node name="Area3D" type="Area3D" parent="lights/world_light_01"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 4, -6)
collision_layer = 32
collision_mask = 32

[node name="CollisionShape3D" type="CollisionShape3D" parent="lights/world_light_01/Area3D"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, -1, 0, 1, -4.37114e-08, 0, -3, 0)
shape = SubResource("BoxShape3D_secdc")

[node name="FlickerComponent" type="Node" parent="lights/world_light_01"]
script = ExtResource("5_gkh44")
metadata/_custom_type_script = "uid://c7ta7ok1g6l83"

[node name="SpotLight3D4" type="SpotLight3D" parent="lights"]
transform = Transform3D(-1, 0, -2.98023e-08, 0, 1, 0, 2.98023e-08, 0, -1, -0.09834, 1.57132, -29.9095)
light_energy = 16.0
shadow_enabled = true
spot_range = 20.0
spot_attenuation = 0.1
spot_angle = 20.0
spot_angle_attenuation = 0.1

[node name="SpotLight3D3" type="SpotLight3D" parent="lights"]
transform = Transform3D(-4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, 9.90166, 1.57132, 19.0905)
light_energy = 16.0
shadow_enabled = true
spot_range = 20.0
spot_attenuation = 0.1
spot_angle = 20.0
spot_angle_attenuation = 0.1

[node name="SpotLight3D2" type="SpotLight3D" parent="lights"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 0, 5, 0)
light_energy = 16.0
shadow_enabled = true
spot_range = 8.0
spot_attenuation = 0.1
spot_angle = 20.0
spot_angle_attenuation = 0.1

[node name="FlickerComponent" type="Node" parent="lights/SpotLight3D2"]
script = ExtResource("5_gkh44")
metadata/_custom_type_script = "uid://c7ta7ok1g6l83"

[node name="objects" type="Node" parent="."]

[node name="block" type="Area3D" parent="objects"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -8, 1, -4)
visible = false
collision_layer = 32
collision_mask = 0
script = ExtResource("9_secdc")

[node name="CollisionShape3D" type="CollisionShape3D" parent="objects/block"]
shape = SubResource("BoxShape3D_j8erv")

[node name="MeshInstance3D" type="MeshInstance3D" parent="objects/block"]
mesh = SubResource("BoxMesh_j8erv")

[node name="StaticBody3D" type="StaticBody3D" parent="objects/block/MeshInstance3D"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="objects/block/MeshInstance3D/StaticBody3D"]
shape = SubResource("ConcavePolygonShape3D_t1try")

[node name="sign" type="Area3D" parent="objects" node_paths=PackedStringArray("body", "interactable")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -6, 4, -9)
visible = false
collision_layer = 32
collision_mask = 0
script = ExtResource("11_t1try")
body = NodePath("MeshInstance3D/StaticBody3D")
interactable = NodePath("MeshInstance3D/StaticBody3D/InteractableComponent")
dialogue = ExtResource("8_j8erv")

[node name="CollisionShape3D" type="CollisionShape3D" parent="objects/sign"]
shape = SubResource("BoxShape3D_t1try")

[node name="MeshInstance3D" type="MeshInstance3D" parent="objects/sign"]
mesh = SubResource("BoxMesh_ef2u0")
surface_material_override/0 = SubResource("StandardMaterial3D_nkto6")

[node name="StaticBody3D" type="StaticBody3D" parent="objects/sign/MeshInstance3D"]
collision_layer = 2
collision_mask = 0

[node name="CollisionShape3D" type="CollisionShape3D" parent="objects/sign/MeshInstance3D/StaticBody3D"]
shape = SubResource("ConcavePolygonShape3D_ycsv1")

[node name="InteractableComponent" type="Node" parent="objects/sign/MeshInstance3D/StaticBody3D"]
script = ExtResource("9_t1try")
metadata/_custom_type_script = "uid://bejw17crfjdit"

[node name="spawn_pos" type="Node" parent="."]

[node name="spawn_from_alley" type="Marker3D" parent="spawn_pos"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, -7.9)
